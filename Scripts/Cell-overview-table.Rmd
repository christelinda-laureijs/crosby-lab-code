---
title: "Cell Summary Tables"
output:
  html_document:
    css: "../Templates/my-CSS-theme.css"
date: "`r format(Sys.time(), '%B %d, %Y')`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE,
                      message=FALSE,
                      warning=FALSE)

source(
  here::here("Scripts/Libraries.R"),
  local = knitr::knit_global(),
  echo = FALSE,
  verbose  = FALSE
)

source(here("Scripts/Functions.R"), local = knitr::knit_global())
source(here("Templates/Theme-options.R"), local = knitr::knit_global())


save_RDS_files <- "no"
```


```{css increase-div-width}
div.main-container {
  max-width: 1400px !important;
}

```

```{r import-data}
# Import and process evoked current data
make_normalized_EPSC_data(filename = "Data/Sample-eEPSC-data.csv",
                          current_type = "eEPSC",
                          min_time_value = 0,
                          max_time_value = 25,
                          interval_length = 5,
                          baseline_length = 5)
make_pruned_EPSC_data(data = raw_eEPSC_df,
                      current_type = "eEPSC",
                      min_time_value = 0,
                      max_time_value = 25,
                      baseline_length = 5,
                      interval_length = 1)

make_normalized_EPSC_data(filename = "Data/Sample-sEPSC-data.csv",
                          current_type = "sEPSC",
                          min_time_value = 0,
                          max_time_value = 25,
                          interval_length = 5,
                          baseline_length = 5)
make_pruned_EPSC_data(data = raw_sEPSC_df,
                      current_type = "sEPSC",
                      min_time_value = 0,
                      max_time_value = 25,
                      baseline_length = 5,
                      interval_length = 1)
```

```{r}
import_cell_characteristics_df(filename = "Data/sample-cell-characteristics.csv")
```

```{r cell-characteristics-table}
cell_characteristics %>%
  rename_with(str_to_title) %>% 
  group_by(Treatment, Sex, Category) %>%
  summarize('Number of cells' = n()) %>%
  reactable(
    columns = list('Number of cells' = colDef(
      style = function(value) {
        if (value < 7) {
          color <- "#950606"
        } else {
          color <- "#000000"
        }
        list(color = color, fontWeight = "bold")
      }
    )),
    highlight = TRUE
  )
```

# Cell Information

```{r make-cell-summary-table}
make_cell_summary_df(
  cell_characteristics_df = cell_characteristics,
  include_all_treatments = "yes",
  list_of_treatments = c("Control"),
  include_all_categories = "no",
  list_of_categories = c("2")
)

make_interactive_summary_table(dataframe = summary_table_data)
```


